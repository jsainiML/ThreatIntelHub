## CVE-2024-55591: 
Critical authentication bypass vulnerability in Fortinet's FortiOS and FortiProxy products, allowing remote attackers to gain super-admin privileges via crafted requests to the Node.js websocket module.

### Description
- **Vulnerability Type:** Authentication Bypass Using an Alternate Path or Channel (CWE-288)
- **Affected Software/Hardware:** FortiOS 7.0.0–7.0.16, FortiProxy 7.0.0–7.0.19, and FortiProxy 7.2.0–7.2.12
- **Severity:** Critical
- **CVSS Score:** 9.6 (Critical)
- **CVE Link:** https://nvd.nist.gov/vuln/detail/CVE-2024-55591

### Technical Details
- **Root Cause:** 
  - The vulnerability exists in the Node.js WebSocket module, allowing remote attackers to gain super-admin privileges via crafted requests25
- **Exploitation Steps:**
  - Attacker sends crafted requests to the Node.js WebSocket module
  - The system fails to properly authenticate the request
  - Attacker gains super-admin privileges on the affected device


### Mitigation
- **Patch/Update:** 
  - Fortinet has released patches to address this vulnerability, grade to FortiOS 7.0.17 or FortiProxy 7.2.132 https://docs.fortinet.com/upgrade-tool
- **Workarounds:** 
  - Disable the HTTP/HTTPS administrative interface
  - Limit IP addresses that can reach the administrative interface via local-in policies8
- **Configuration Changes:** 
  - Disable firewall management access on public interfaces8


### Indicators of Compromise (IoCs)
- **Actviity performed by the Threat Actor:**
  - Unauthorized administrative logins on management interfaces
  - Creation of new accounts, especially super admin accounts
  - SSL VPN authentication through newly created accounts
  - Unusual configuration changes
- **IPs:**
  - 1.1.1.1
  - 127.0.0.1
  - 2.2.2.2
  - 8.8.8.8
  - 8.8.4.4
  - 45.55.158.47 
  - 87.249.138.47
  - 155.133.4.175
  - 37.19.196.65
  - 149.22.94.37
- **User created by the TA is randomly generated:**
  - Gujhmk
  - Ed8x4k
  - G0xgey
  - Pvnw81

- **Example Log:**
```
#Following login activity log with random scrip and dstip:
type="event" subtype="system" level="information" vd="root" logdesc="Admin login successful" sn="1733486785" user="admin" ui="jsconsole" method="jsconsole" srcip=1.1.1.1 dstip=1.1.1.1 action="login" status="success" reason="none" profile="super_admin" msg="Administrator admin logged in successfully from jsconsole"

#Following admin creation log with seemingly randomly generated user name and source IP:
type="event" subtype="system" level="information" vd="root" logdesc="Object attribute configured" user="admin" ui="jsconsole(127.0.0.1)" action="Add" cfgtid=1411317760 cfgpath="system.admin" cfgobj="vOcep" cfgattr="password[*]accprofile[super_admin]vdom[root]" msg="Add system.admin vOcep"

date=2024-12 time=REDACTED devname="REDACTED" devid="REDACTED" eventtime=1733554955692189638 tz="-0500" logid="0100044547" type="event" subtype="system" level="information" vd="root" logdesc="Object attribute configured" user="admin" ui="jsconsole(127.0.0.1)" action="Add" cfgtid=REDACTED cfgpath="system.admin" cfgobj="Dbr3W" cfgattr="password[*]accprofile[super_admin]vdom[root]" msg="Add system.admin Dbr3W"
```


  ### References
  - https://fortiguard.fortinet.com/psirt/FG-IR-24-535
  - https://arcticwolf.com/resources/blog/console-chaos-targets-fortinet-fortigate-firewalls/
  - https://www.bleepingcomputer.com/news/security/fortinet-warns-of-auth-bypass-zero-day-exploited-to-hijack-firewalls/
