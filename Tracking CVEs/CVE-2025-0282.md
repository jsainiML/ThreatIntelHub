## CVE-2025-0282
CVE-2025-0282 is a critical stack-based buffer overflow vulnerability affecting Ivanti Connect Secure, Policy Secure, and Neurons for ZTA gateways. Exploiting this flaw allows remote, unauthenticated attackers to execute arbitrary code on the affected devices. Ivanti has released patches to address this issue; users should update to the latest versions immediately. Active exploitation of this vulnerability has been observed in the wild since mid-December 2024. 

### Description
- **Vulnerability Type:** Unauthenticated Stack-Based Buffer Overflow
- **Affected Software/Hardware:**
  - Ivanti Connect Secure versions 22.7R2 through 22.7R2.4
  - Ivanti Policy Secure versions 22.7R1 through 22.7R1.2
  - Ivanti Neurons for ZTA versions 22.7R2 through 22.7R2.3
- **Severity:** Critical
- **CVSS Score:** 9.0 (Critical)
- **CVE Link:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

### Technical Details
- **Root Cause:**
  - The vulnerability arises from improper handling of input data, leading to a stack-based buffer overflow. This flaw allows remote, unauthenticated attackers to execute arbitrary code on the affected device.
- **Exploitation Steps:**
  - Perform reconnaissance by querying specific URLs to determine the ICS appliance version
  - Craft and send a HTTP requests, malicious input triggers a buffer overflow, overwriting the return address on the stack.
  - Disable SELinux and prevent syslog forwarding
  - Remount the filesystem as read-write
  - Execute scripts to drop web shells and modify system components
  - Remove specific log entries and clear evidence of the attack


### Mitigation
- **Patch/Update:** 
  - Ivanti released patches for Connect Secure ([version 22.7R2.5](https://portal.ivanti.com/)) on January 8, 2025
  - Ivanti Policy Secure & Ivanti Neurons for ZTA gateways - Patch planned availability Jan. 21 
  - https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Connect-Secure-Policy-Secure-ZTA-Gateways-CVE-2025-0282-CVE-2025-0283?language=en_US
- **Workarounds:** 
  - If immediate patching is not feasible, consider disabling remote access to the administrative interface and restricting access to trusted IP addresses.  
- **Configuration Changes:** 
  - Run the In-Build Integrity Checker Tool and monitor both internal and external ICT results


### Detection
- **Indicators of Compromise (IoCs):**
  - HTTP requests from VPS providers or Tor networks to specific URLs, especially in sequential version order
  - Deployment of SPAWN, DRYHOOK, and PHASEJAM malware families
  - Modifications to getComponent.cgi, restAuth.cgi, and DSUpgrade.pm files
  - Overwriting of the remotedebug executable
- **Suricata Rule Example:** 
  ```
    alert http any any -> any any (
    msg:"Potential CVE-2025-0282 exploitation attempt";
    content:"POST"; http_method;
    content:"/dana-na/"; http_uri;
    pcre:"/\.cgi\?/"; http_uri;
    sid:0000001;
    rev:1;)
  ```

  ### References
  - https://cloud.google.com/blog/topics/threat-intelligence/ivanti-connect-secure-vpn-zero-day
  - https://www.tenable.com/blog/cve-2025-0282-ivanti-connect-secure-zero-day-vulnerability-exploited-in-the-wild
  - https://thehackernews.com/2025/01/ivanti-flaw-cve-2025-0282-actively.html
  - https://www.wiz.io/blog/cve-2025-0282-and-cve-2025-0283-critical-ivanti-0days-exploited-in-the-wild
  - https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Connect-Secure-Policy-Secure-ZTA-Gateways-CVE-2025-0282-CVE-2025-0283?language=en_US
  - https://nvd.nist.gov/vuln/detail/CVE-2025-0282
